Конфигурационное управление — Вариант 19

Реализация инструмента командной строки на Python + Lark

Описание

Проект реализует инструмент командной строки, который читает текст на учебном конфигурационном языке (вариант №19) и преобразует его в XML.

Функции инструмента:

Чтение входного файла с конфигурацией.

Разбор синтаксиса с использованием Lark (специализированный инструмент синтаксического анализа).

Обработка деклараций констант вида:

NAME is значение;

Вычисление константных выражений вида:

!(выражение)


Поддержка инфиксных операций: +, -, *, /, а также функции mod(a, b).

Формирование внутренней структуры данных (словарей).

Генерация XML-файла на основе полученной структуры.

Обработка синтаксических и семантических ошибок.

Наличие примеров конфигураций и базовых тестов.

Требования

Python 3.9+

Установленные зависимости из requirements.txt

Установка зависимостей

Рекомендуется использовать виртуальное окружение.

Активация:

Зайти в cmd 
Прописать путь до папки проекта (cd ....)

Прописать команду для активации виртуального окружения

.venv\Scripts\activate.bat

После этого перед строкой ввода команд должно появится (.venv)

Установка библиотек:

pip install -r requirements.txt

Структура проекта
config19/
    cli.py          — интерфейс командной строки
    parser.py       — парсер, вычисление констант
    xmlgen.py       — генерация XML
    grammar.lark    — грамматика конфигурационного языка
    __init__.py

examples/
    network.cfg
    game.cfg
    users.cfg

tests/
    test_basic.py

requirements.txt
README.md

Запуск программы
Инструмент вызывается как модуль Python.

Пример запуска:

Для конфига сети:
python -m config19.cli -i examples/network.cfg -o network.xml

Для конфига игры:
python -m config19.cli -i examples/game.cfg -o game.xml

Для конфига пользователя:
python -m config19.cli -i examples/users.cfg -o users.xml

Параметры:

-i, --input — путь к входному .cfg файлу

-o, --output — путь к выходному XML файлу

После выполнения в указанном файле будет сохранён XML, соответствующий конфигурации.

Запуск тестов

Для запуска тестов используется pytest:

В CMD написать команду pytest. После этого можно увидеть на какой процент выполняется тест

Примеры конфигураций

Примеры расположены в каталоге examples/:

network.cfg — пример конфигурации сетевого сервера

game.cfg — пример игровой конфигурации

users.cfg — пример конфигурации пользователей и уровней доступа

Грамматика

Грамматика языка описана в файле grammar.lark и включает поддержку:

словарей вида @{ key = value; ... }

строк "text"

чисел, включая научную форму

констант NAME is value;

выражений !(a + b), !(mod(a, b))
